# Li-Ion-UPS-18650
Describe how to create simple, cheap and efficient UPS, based on 18650 Li-Ion batteris

Традиційні ББЖ/UPS досить ефективні коли мова йде за навантаження більше 100Вт і які потребують для своєї роботи 220в. Якщо ж мова йде за невеликі навантаження які в свою чергу оснащені БЖ на 5/9/12в, то наяність перетворювачів з 6/12 DC в 220 AC (частина UPS) і потім 220 AC в 5/9/12 DC (БЖ присторою) виглядає надлишковою. Опишу мої потугі щоб створити міні блок безперервного живлення на базі Li-Ion 18650 акумуляторів які би напряму заряжались і живили присторої на 5/9/12 В.

### Задача #1

#### YI Home Camera

Є IP-камера відеоспостереження YI Home Camera 1080p. Є запис на MicroSD карточку.

Камера живиться по Micro USB. В комплекті іде БЖ з виходом 5В і 1А.

Стандартне споживання ~250mA. В нічному режимі із-за інфрачервоного підсвічування струм зростає до ~400mA.

Забезпечити можливість автономної роботи Wi-Fi камери.

![](https://github.com/abajavascript/Li-Ion-UPS-18650/blob/master/YiHome-photo.jpg) 


 

### Версія #0.0

#### Контроллер TP4056 Для Li-Ion

Першим в руки попав контроллер для Li-Ion на базі TP4056.

Має вхід для 5В через Micro USB або можна найти версію з контактами на платі.

![](https://github.com/abajavascript/Li-Ion-UPS-18650/blob/master/TP4056-photo.jpg)

Cons: Відсутній захист від перезаряду і перерозряду батареї. Треба окремо BMS модуль для захисту батареї. Нема можливості підєднання батареї. Використання можливе лише в варіанті CC/CD зарядного.

На тому експеременти з тим модулем завершились.



 
### Версія #0.1

#### Контроллер TP4056+DW01 Для Li-Ion

Для наступного експеременту пішла більш просунута версія Li-Ion контролера на базі TP4056 яка вже має модуль захисту батареї реалізований на чіпі DW01.

![](https://github.com/abajavascript/Li-Ion-UPS-18650/blob/master/TP4056-DW01-photo.jpg) 

Чомусь вирішив що даний модуль є завершеним рішенням і на виході дає також 5В як і на вході.

![](https://github.com/abajavascript/Li-Ion-UPS-18650/blob/master/TP4056-DW01-schema.jpg)

Cons: На виході нема 5В. Отже, на вході 5В, на батареї напруга від <3 до 4,2в залежно від заряду батареї, на виході то саме що і на батареї. Батарея була заряджена і камера стартанула і працювала від ~4В. Напруга на виході не 5В.




### Версія #0.2

#### Контроллер TP4056+DW01 і MT3608

Отже для фіксання вихідної напруги контроллера TP4056+DW01 щоб на виході було 5В треба DC-DC StepUp. Під руками був лише регульований на базі MT3608.

![](https://github.com/abajavascript/Li-Ion-UPS-18650/blob/master/MT3608-photo.jpg)

До речі получилось рішення дуже подібне до того що описано в https://habr.com/ru/post/444076/

Досить адекватне рішення. Залишилось зібрати і протестувати, чи зможе це бути заміною UPS чи лише як повербанк рішення. Отже схема виглядає такою:

![](https://github.com/abajavascript/Li-Ion-UPS-18650/blob/master/TP4056-DW01-MT3608-schema.jpg)

#### Вольтамперметр

Трошки відступу. Для того щоб зібрати інфу про детальну поведінку схеми треба періодично міряти струм і напругу у всіх точках схеми. Прбував використовувати мультиметр(и). Якщо напругу в якійсь точці ще можна міряти періодично мультиметром, то зі струмом проблематично, бо мультиметр сам вирубається що 15 хв. З найдешевшого в китайців був оцей вольтамперметр постійного струму.

![](https://github.com/abajavascript/Li-Ion-UPS-18650/blob/master/VA.jpg)

Найшов в україні не набагато дорожче ніж в китайців. І варіант з Києва на завтра переміг варіант з Китаю за місяць (або два) і дешевше на пару центів. Ще би Нова Пошта трохи менше дерла, можна би було взагалі з Китаю не замовляти. Так от чотири таких девайса запхано в кожну гілку, для моніторинга.

![](https://github.com/abajavascript/Li-Ion-UPS-18650/blob/master/TP4056-DW01-MT3608-VA-schema.jpg)

Cons: Дані модулі мають два варіанта підключення: з живленням від вимірюваної напруги і з зовнішнім живленням. В першому варіанті проблема що напруга має бути >4В (в реальності десь 3.0-3.2В), бо інакше маєм потухший екран. А при схемі з зовнішнім живленням вилізла бага. Я всі ВАметри підключив до одного БЖ на 9В, тобто у всіх виявились зєднані +/- живлення і це мало наслідки. Один з ВАметрів не показував струм. Другий нюанс з тими девайсами - вони показують лише струм з полярністю відповідною підключенню. Це не дуже добре для гілки з батареєю. Коли батарея заряжається струм заряду відображається, коли розряд батареї показує 0А.

#### Тестування



